import{C as y,P as D,a as b,d as g,_ as P}from"./nofound80-b0b6492e.js";import{_ as v,i as M,m as k,a as H,r as l,o as i,c as n,b as s,d as c,w as f,v as V,F as p,e as B,f as G,g as h,t as m}from"./index-98feb353.js";const A={data(){return{paginatedDatas:[],filteredDatasCache:[],search:!1,selectedCategory:"",selectedCity:"",selectedValue:"",selectedData:"",keyword:"",onePage:20,currentPage:1,categories:[{name:"地方特產",imgUrl:"https://images.unsplash.com/photo-1589553288887-3ee1f709e119?ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&ixlib=rb-1.2.1&auto=format&fit=crop&w=ˋㄢ&q=80",value:"地方特產"},{name:"中式美食",imgUrl:"https://images.unsplash.com/photo-1551851300-1fd39219a668?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=ˋ400&q=80",value:"中式美食"},{name:"異國料理",imgUrl:"https://images.unsplash.com/photo-1611171711791-b34fa42e9fc2?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1287&q=80",value:"異國料理"},{name:"素食",imgUrl:"https://images.unsplash.com/photo-1498837167922-ddd27525d352?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1170&q=80",value:"素食"},{name:"甜點冰品",imgUrl:"https://images.unsplash.com/photo-1470124182917-cc6e71b22ecc?ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&ixlib=rb-1.2.1&auto=format&fit=crop&w=400&q=80",value:"甜點冰品"},{name:"伴手禮",imgUrl:"https://plus.unsplash.com/premium_photo-1664474816376-408f8ba74be2?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=687&q=80",value:"伴手禮"}]}},components:{CityComponent:y,PageComponent:D,FoodsComponent:M,CategoriesComponent:b},computed:{...k(g,["datas"]),pageCount(){return Math.ceil(this.filteredDatas().length/this.onePage)},pageNumbers(){const e=Math.min(this.pageCount,10),t=[],d=Math.max(1,this.currentPage-Math.floor(e/2)),u=Math.min(this.pageCount,d+e-1);for(let a=d;a<=u;a++)t.push(a);return t}},methods:{...H(g,["getFood"]),filteredDatas(){let e=[...this.datas];return this.selectedCategory&&(e=e.filter(t=>t.Class===this.selectedCategory),this.currentPage=1),this.keyword&&(e=e.filter(t=>t.RestaurantName.includes(this.keyword)),this.currentPage=1),e},handlePageClick(e){e==="prev"&&this.currentPage>1?this.currentPage--:e==="next"&&this.currentPage<this.pageCount?this.currentPage++:this.currentPage=e,this.$nextTick(()=>{window.scrollTo(0,0)}),this.updatePaginatedDatas()},handleCityChange(e){this.selectedCity=e},async searchDatas(e){this.search=!0,this.currentPage=1,this.selectedCategory=e,this.selectedCity?(await this.getFood(this.selectedCity),this.filteredDatasCache=this.filteredDatas(),this.updatePaginatedDatas()):(await this.getFood(),this.filteredDatasCache=this.filteredDatas(),this.updatePaginatedDatas())},updatePaginatedDatas(){const e=(this.currentPage-1)*this.onePage,t=e+this.onePage;this.paginatedDatas=this.filteredDatasCache.slice(e,t)}},mounted(){this.$route.query.keyword!==void 0&&this.searchDatas()}},F={class:"row gy-2 mb-3"},N={class:"col-12 col-lg-2"},U={class:"col-12 col-lg-2"},q=s("option",{value:""},"全部種類",-1),j=["value"],S={class:"col-12 col-lg-6"},W={class:"col-12 col-lg-2"},Y={key:0},T=s("h3",null,"熱門主題",-1),I={key:1},E={class:"fs-6"},L={key:0,class:"row mt-3"},R={key:1,class:"text-center mt-4"},z=s("img",{src:P,alt:"nofound80",style:{width:"100px",margin:"0 auto"}},null,-1),J=s("h5",{class:"mt-3"},[h(" 目前查無資料 "),s("br"),h(" 請重新搜尋 ")],-1),K=[z,J];function O(e,t,d,u,a,r){const C=l("CityComponent"),x=l("CategoriesComponent"),_=l("FoodsComponent"),w=l("PageComponent");return i(),n(p,null,[s("div",F,[s("div",N,[c(C,{onCityChange:r.handleCityChange},null,8,["onCityChange"])]),s("div",U,[f(s("select",{class:"form-select","onUpdate:modelValue":t[0]||(t[0]=o=>a.selectedValue=o)},[q,(i(!0),n(p,null,B(a.categories,o=>(i(),n("option",{value:o.value,key:o.name},m(o.name),9,j))),128))],512),[[V,a.selectedValue]])]),s("div",S,[f(s("input",{class:"border rounded bg-light fs-5 px-3 py-1 w-100",type:"text",placeholder:"你想去哪裡？請輸入關鍵字","onUpdate:modelValue":t[1]||(t[1]=o=>a.keyword=o)},null,512),[[G,a.keyword,void 0,{trim:!0}]])]),s("div",W,[s("button",{type:"button",class:"btn btn-primary fs-5 text-white w-100",onClick:t[2]||(t[2]=o=>r.searchDatas(this.selectedValue))}," 搜 尋 ")])]),a.search?(i(),n("div",I,[s("h3",null,[h(" 搜尋結果 "),s("span",E,"共 "+m(a.filteredDatasCache.length)+" 筆資料",1)]),a.paginatedDatas.length>0?(i(),n("div",L,[c(_,{datas:a.paginatedDatas},null,8,["datas"]),c(w,{currentPage:a.currentPage,pageCount:r.pageCount,pageNumbers:r.pageNumbers,onPageClicked:r.handlePageClick},null,8,["currentPage","pageCount","pageNumbers","onPageClicked"])])):(i(),n("div",R,K))])):(i(),n("div",Y,[T,c(x,{categories:a.categories,onCategorySelected:r.searchDatas},null,8,["categories","onCategorySelected"])]))],64)}const Z=v(A,[["render",O]]);export{Z as default};
